"use strict";function Vic(t,e){return this.fps=40,this.items=t,this.$el=e,this.$video=this.$el.find("video"),this.$video_wrap=this.$video.parent(),this.$selected_item_wrap=this.$el.find(".selected_item_wrap"),this.controls={$play:this.$el.find(".controls .play"),$pause:this.$el.find(".controls .pause")},this.video=this.$video[0],this.pauseFlag=!1,this.started=!1,this.templates={modal:_.template($("#vic_modal_contents").html()),selected_item:_.template($("#vic_selected_item").html())},this.$pointer=$(".vic-mouse"),this.init(),this}function initializeVic(){for(var t=0;items.length>t;t++){new Vic(items[t],$("#video-"+t));for(var e=0;items[t].length>e;e++){var a=$("<form>");shopCartConf.id="form-"+items[t][e].itemName,a.attr(shopCartConf),items[t][e].cartProps&&$.each(items[t][e].cartProps,function(t,e){a.append($("<input>").attr({name:t,value:e}))}),a.append($("<input>").attr({type:"submit",name:"買い物カゴに入れる"})),$("body").append(a)}$("body").append($('<iframe name="nodisp" id="naiyo" style="display:none">'))}}Vic.prototype.play=function(){0==this.started?(this.createItemObjects(),this.started=!0,this.pointerPlay_()):this.pauseFlag=!1,this.controls.$play.hide(),this.controls.$pause.fadeIn(),this.video.play()},Vic.prototype.pause=function(){0==this.started||(this.pauseFlag=!0,this.controls.$pause.hide(),this.controls.$play.fadeIn()),this.video.pause()},Vic.prototype.pointerPlay_=function(){function t(){setTimeout(function(){if(a.ended)e.started=!1,$("#timeDisplay").text("");else{if(!e.pauseFlag)for(var s=0;i.length>s;s++){var o=i[s].$dom;o.data("startTime")<a.currentTime&&!o.data("added")?(o.data("added",!0),e.putItem(o)):o.data("endTime")<a.currentTime&&o.data("added")?(o.stop(),o.css("display","none")):e.moveItem(o)}t(),$("#timeDisplay").text(a.currentTime)}},1e3/e.fps)}var e=this,a=this.video,i=this.items;t()},Vic.prototype.createItemObjects=function(){for(var t=this,e=this.items,a=0;e.length>a;a++){var i=e[a].itemName,s=e[a].top,o=e[a].left,n=e[a].width,r=e[a].height,p=e[a].startTime,d=e[a].startTime+e[a].duration,l=e[a].url,m=e[a].translateX/(e[a].duration*this.fps),c=e[a].translateY/(e[a].duration*this.fps),h=$("<div>",{id:i,"class":"vic-itemPointer"});if(h.css({top:s,left:o,position:"absolute",margin:"20px",width:n,height:r}),h.data("startTime",p),h.data("endTime",d),h.data("url",l),h.data("distanceByFrameX",m),h.data("distanceByFrameY",c),h.data("top",s),h.data("left",o),h.data("width",n),h.data("height",r),"undefined"!=typeof e[a].tag){var f=$("<div>").css(e[a].tag.css);e[a].tag.text&&f.append($("<p>"+e[a].tag.text+"</p>")),h.append(f)}e[a].$dom=h,h.on("click",e[a],function(e){e.data.selected=!0,t.renderSelectedItems()}),h.bind({mouseover:function(e){console.log("enter"),t.$pointer.fadeIn()},mouseout:function(e){console.log("out"),t.$pointer.fadeOut()}})}},Vic.prototype.putItem=function(t){this.$video_wrap.append(t)},Vic.prototype.movieStop=function(){this.pause()},Vic.prototype.moveItem=function(t){t.data("added")&&(t.data("left",t.data("left")+t.data("distanceByFrameX")),t.data("top",t.data("top")+t.data("distanceByFrameY")),t.css({left:t.data("left")}),t.css({top:t.data("top")}))},Vic.prototype.openModal=function(t){var e=this,a=$(this.templates.modal({item:t})),i=this.$video_wrap;return a.find(".close").on("click",function(t){a.remove(),e.play()}),a.find(".add_item").on("click",function(a){t.selected=!0,t.cartAdded=!0,e.addCart(t)}),i.append(a),this},Vic.prototype.addCart=function(t){$("#form-"+t.itemName).submit(),console.log(t.itemName),$(".layer_"+t.itemName).remove()},Vic.prototype.renderSelectedItems=function(){var t=_.where(this.items,{selected:!0}),e=this,a=this.$selected_item_wrap.find(".vic-btn_area"),i=this.$selected_item_wrap.find(".selected_item_area");a.empty(),t.length>0?(a.html('<div class="vic-btn vic-btn-default add_to_cart"><a href='+shopCartConf.cartUrl+' target="_blank">購入手続きへ進む</a></div>'),a.find(".add_to_cart").on("click",function(t){})):a.find(".btn_area").empty(),i.empty();for(var s=0;t.length>s;s++){var o=$(this.templates.selected_item({item:t[s]}));o.find(".unselect").each(function(){$(this).on("click",t[s],function(t){t.data.selected=!1,e.renderSelectedItems()})}),o.on("click",t[s],function(t){e.movieStop(),e.openModal(t.data)}),i.append(o)}},Vic.prototype.init=function(){var t=this;this.controls.$play.hide(),this.controls.$pause.hide(),this.$el.find(".play").each(function(){$(this).on("click",function(){t.play()})}),this.$el.find(".pause").each(function(){$(this).on("click",function(){t.pause()})}),this.$video_wrap.on("mouseenter",function(e){t.showControls()}),this.$video_wrap.on("mouseleave",function(e){t.hideControls()}),this.video.addEventListener("playing",function(e){t.onPlaying(e)}),this.video.addEventListener("ended",function(e){t.started=!1,t.controls.$play.fadeIn(),t.controls.$pause.hide(),t.onEnded(e)}),$(document).off("mousemove"),this.$pointer.hide(),$(document).on("mousemove",function(e){t.followPointer(e)}),this.createItemObjects()},Vic.prototype.showControls=function(){this.started?this.controls.$pause.fadeIn():this.controls.$play.fadeIn()},Vic.prototype.hideControls=function(){this.started?this.controls.$pause.fadeOut():this.controls.$play.fadeOut()},Vic.prototype.onPlaying=function(t){console.log("playing")},Vic.prototype.onEnded=function(t){console.log("ended")},Vic.prototype.followPointer=function(t){var e=t.pageX-13,a=t.pageY-18,i=50,s=50;i+=e-i,s+=a-s,this.$pointer.css({left:i,top:s})},window.onload=function(){initializeVic()};var items=[[{itemName:"item1",top:10,left:330,width:133,height:289,startTime:0,url:"http://amzn.to/1Si7qIT",details:{name:"驚くほどのストレッチ！美脚ストレートパンツ",price:"1,900",description:"膝位置高めで脚長効果抜群。内側ボタン式だからウエストすっきり。素材	レーヨン77%・ナイロン20%・ポリウレタン3%  <br>モデル:身長：168cm/Sサイズ",image:{thumbnail:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/item.jpg",small:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/item.jpg",large:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/item8.jpg"},item_id:11},translateX:0,translateY:0,duration:3,tag:{text:"ストレートパンツ<br>¥1,900",css:{"font-family":"NotoSansCJKjp-Bold",color:"white",fontWeight:"bold",textShadow:"0 1px 1px rgba(0,0,0,.4)",position:"absolute",bottom:"-50px",right:"-50px"}},cartProps:{item_cd:"MK_2132",ITEMPROPERTY_CD:"C0034-S001",request:"insert",CART_AMOUNT:"1"}},{itemName:"item2",top:150,left:0,width:165,height:160,startTime:4,url:"http://amzn.to/1Si7qIT",details:{name:"サンセベリア",price:"1,980",description:"説明：明るい場所～半日陰で育てます。日によく当てれば葉の色が濃く、大きな葉っぱに成長します。窓から少し離れた、部屋の中程でも管理できます。",image:{thumbnail:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/02.jpg",small:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/02.jpg",large:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/02.jpg"},item_id:11},translateX:250,translateY:0,duration:3,tag:{text:"観葉植物<br>¥1,980",css:{"font-family":"NotoSansCJKjp-Bold",color:"white",fontWeight:"bold",textShadow:"0 1px 1px rgba(0,0,0,.4)","font-size":"20px",position:"absolute",bottom:"-20px",right:"-100px"}},cartProps:{item_cd:"MK_2132",ITEMPROPERTY_CD:"C0034-S001",request:"insert",CART_AMOUNT:"1"}},{itemName:"item3",top:50,left:150,width:340,height:315,startTime:7,url:"http://amzn.to/1NLQM2D",details:{name:"クレエ 本立て A",price:"9,800",description:"木とアイアンのシンプルなブックスタンド。A4サイズや雑誌サイズまでがぴったり収まるサイズです。コンパクトでちょっとしたスペースで使いやすいサイズにしました。",image:{thumbnail:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/01.jpg",small:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/01.jpg",large:"http://s3-ap-northeast-1.amazonaws.com/vic-video/parco/assets/images/01.jpg"},item_id:11},translateX:0,translateY:0,duration:3,tag:{text:"ブックスタンド<br>¥2,700",css:{"font-family":"NotoSansCJKjp-Bold",color:"white",fontWeight:"bold",textShadow:"0 1px 1px rgba(0,0,0,.4)","font-size":"25px",position:"absolute",top:"10px"}},cartProps:{item_cd:"4530956523057",ITEMPROPERTY_CD:"C0237-S012",request:"insert",CART_AMOUNT:"1"}}],[{itemName:"sneaker-1",top:180,left:150,width:240,height:120,startTime:0,url:"http://amzn.to/1Qu5der",details:{name:"ナイキ ルナテンポ",price:"11,880",description:"軽量性、サポート力のあるフィット感、足裏の柔らかいクッショニングが特長。ランニング中に抜群に滑らかな履き心地を実現します。",image:{thumbnail:"./assets/images/03.jpg",small:"./assets/images/03.jpg",large:"./assets/images/03.jpg"},item_id:11},translateX:0,translateY:0,duration:3,tag:{text:"ランニングシューズ<br>¥11,880",css:{"font-family":"NotoSansCJKjp-Bold",color:"white","font-size":"15px",position:"absolute",bottom:"-10px"}}},{itemName:"t-shirt-1",top:40,left:135,width:160,height:250,startTime:3.8,url:"http://amzn.to/1ShM4KS",details:{name:"ナイキ DRI-FIT コントアー",price:"4,860",description:"最高のパフォーマンスのために必要不可欠な通気性を実現。メッシュニットが高い通気性を確保した体に沿うデザイン。体温が上昇しても快適なカバー力で軽快な動きが可能。",image:{thumbnail:"./assets/images/04.jpg",small:"./assets/images/04.jpg",large:"./assets/images/04.jpg"},item_id:11},translateX:-130,translateY:0,duration:1,tag:{text:"ランニングシャツ<br>¥4,860",css:{"font-family":"NotoSansCJKjp-Bold",color:"white","font-size":"15px",position:"absolute",bottom:"-10px"}}},{itemName:"t-shirt-2",top:40,left:180,width:110,height:200,startTime:4.8,url:"http://amzn.to/1ShM4KS",details:{name:"ナイキ DRI-FIT コントアー",price:"4,860",description:"最高のパフォーマンスのために必要不可欠な通気性を実現。メッシュニットが高い通気性を確保した体に沿うデザイン。体温が上昇しても快適なカバー力で軽快な動きが可能。",image:{thumbnail:"./assets/images/04.jpg",small:"./assets/images/04.jpg",large:"./assets/images/04.jpg"},item_id:11},translateX:300,translateY:0,duration:2,tag:{text:"ランニングシャツ<br>¥4,860",css:{"font-family":"NotoSansCJKjp-Bold",color:"white","font-size":"15px",position:"absolute",bottom:"-10px"}}},{itemName:"sneaker-2",top:180,left:320,width:170,height:130,startTime:8,url:"http://amzn.to/1Qu5der",details:{name:"ナイキ ルナテンポ",price:"11,880",description:"軽量性、サポート力のあるフィット感、足裏の柔らかいクッショニングが特長。ランニング中に抜群に滑らかな履き心地を実現します。",image:{thumbnail:"./assets/images/03.jpg",small:"./assets/images/03.jpg",large:"./assets/images/03.jpg"},item_id:11},translateX:0,translateY:150,duration:2,tag:{text:"ランニングシューズ<br>¥11,880",css:{"font-family":"NotoSansCJKjp-Bold",color:"white","font-size":"15px",position:"absolute",top:"-20px"}}},{itemName:"t-shirt-3",top:0,left:355,width:170,height:133,startTime:13,url:"http://amzn.to/1ShM4KS",details:{name:"ナイキ DRI-FIT コントアー",price:"4,860",description:"最高のパフォーマンスのために必要不可欠な通気性を実現。メッシュニットが高い通気性を確保した体に沿うデザイン。体温が上昇しても快適なカバー力で軽快な動きが可能。",image:{thumbnail:"./assets/images/04.jpg",small:"./assets/images/04.jpg",large:"./assets/images/04.jpg"},item_id:11},translateX:0,translateY:200,duration:4,tag:{text:"ランニングシャツ<br>¥4,860",css:{"font-family":"NotoSansCJKjp-Bold",color:"white","font-size":"15px",position:"absolute",bottom:"-10px"}}}]],shopCartConf={method:"POST",action:"https://www.meetscal.parco.jp/cart_index.html",style:"display:none;",target:"nodisp",cartUrl:"https://www.meetscal.parco.jp/cart_index.html"};